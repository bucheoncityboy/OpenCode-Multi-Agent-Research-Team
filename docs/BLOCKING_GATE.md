# 🚨 BLOCKING GATE (전략 승인 기준)

> ⚠️ **[MANDATORY]** 모든 검증 에이전트는 이 문서를 **반드시 먼저** 읽고 적용할 것!
> 하나라도 미통과 시 **즉시 기각 후 재시도**. 예외 없음.

---

## 1. 필수 통과 조건 (ALL MUST PASS)

| 항목 | 기준 | 미통과 시 조치 |
|------|------|---------------|
| **OOS/IS KPI 비율** | OOS ≥ IS × 70% | 파라미터 축소, 피처 제거 |
| **Monte Carlo p-value** | < 0.05 (1000회 셔플) | 시그널 로직 단순화 |
| **Bootstrap 95% CI** | 주요 KPI 하한 > 0 | 샘플 확대, 필터 완화 |
| **WFO 일관성** | 3-fold 이상, Embargo 적용 | 과적합 피처 제거 |
| **Trade Count** | N > 30 | 진입 조건 완화 |
| **Purged K-Fold** | Train/Test 누수 차단 | Embargo 기간 설정 |
| **.shift(1)** | 모든 피처 적용 | 누수 수정 후 재검증 |

---

## 2. 전략 유형별 KPI

| 전략 유형 | Primary KPI | Secondary KPI |
|-----------|-------------|---------------|
| **추세 추종 (Trend)** | Sharpe | Calmar, MDD |
| **평균 회귀 (Mean-Rev)** | Sortino | Win Rate, Avg Win/Loss |
| **차익/저위험 (Arb)** | Sortino | IR, 거래당 수익 |
| **롱온리 (Long-Only)** | IR (vs Benchmark) | Alpha, Beta |

---

## 3. WFO (Walk-Forward) 상세 규칙

1. **최소 3-fold 필수** (예: 2020-2022 IS → 2022-2023 OOS)
2. **Embargo 기간**: 최소 5일 (고빈도 전략은 1시간 이상)
3. **Purged K-Fold**: Train 마지막 ↔ Test 첫 부분 겹침 방지
4. **각 fold별 OOS ≥ IS × 70%** 유지
5. **fold간 성과 표준편차** 과도 시 레짐 의존성 의심 → 기각

---

## 4. 차익거래/페어트레이딩 특수 검증

> ⚠️ 저위험 전략은 Sharpe만으로 평가 금지!

| 항목 | 설명 |
|------|------|
| **Execution Latency** | 체결 지연에 따른 수익성 민감도 |
| **Capacity Constraint** | AUM 증가 시 수익 곡선 붕괴 여부 |
| **Slip-to-Spread** | 슬리피지 vs 스프레드 수익 비율 |
| **Orderbook Realism** | 실제 호가창 기반 검증 필수 |

---

## 5. 포트폴리오 KPI

### 일반 (주식/FX)
| 지표 | 기준 |
|------|------|
| 평균 상관 | < 0.3 |
| 롤링 최대 상관 | < 0.7 |
| 위기 상관 | < 0.6 |

### 크립토
| 지표 | 기준 |
|------|------|
| 평균 상관 | < 0.5 |
| 롤링 최대 상관 | < 0.85 |
| 위기 상관 | < 0.8 |

### 공통
| 지표 | 기준 |
|------|------|
| Portfolio Sharpe | > 개별 평균 |
| 분산효과 | > 1.2 |
| 집중도 | 단일 < 40% |

---

## 6. 검증 체크리스트

- [ ] IS vs OOS (저하 < 30%)
- [ ] 파라미터:데이터 (< 1:10)
- [ ] WFO 3-fold 일관성
- [ ] .shift(1) 확인
- [ ] Embargo 적용
- [ ] Monte Carlo p < 0.05
- [ ] B&H 대비 IR > 0
- [ ] 거래비용 (Maker 2bp, Taker 5bp)
- [ ] N > 30

---

## 7. 미통과 시 프로토콜

```
실패 → 원인 분석 → 수정 → 재검증 → 성공까지 무한 반복
"실패" 선언 후 종료 절대 금지!
```

---

## 🔐 참조 검증 코드
**이 문서를 읽었다면 검증 시작 시 반드시 출력**: `[BG-v1-OK]`
